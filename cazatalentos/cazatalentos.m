n=[10:1:420]

t=1.645
t=1.282


%t=1.291
v1=t.*sqrt(n*.599)./n+.599

v2=-t.*sqrt(n*.7)./n+.7

plot(n,v1,n,v2)

n=[10:1:420]
yi=.7
y0=.599
N90=(1.282*(sqrt(yi)+sqrt(y0))/(yi-y0))^2
N75=(0.6745*(sqrt(yi)+sqrt(y0))/(yi-y0))^2
t=sqrt(n)*(yi-y0)/(sqrt(yi)+sqrt(y0))
t=sqrt(n)*(yi-y0)/(2*(sqrt(yi+y0)))

%si p=0.9 y nu=200 mas de 100 ya da lo mismo
x = tinv(p,nu)

nu=100
p=[0.5:0.001:.9];
x = tinv(p,nu)



N1=90
x=[.501:0.001:.599]
y=x*N1+1.282.*sqrt(x)*sqrt(N1)
yf=0.7-1.282*sqrt(0.7)/sqrt(N1)

y=x*N1+1.291.*sqrt(x)*sqrt(N1)
yf=0.7-1.291*sqrt(0.7)/sqrt(N1)

yt=[y yf]
median(yt)

N1=90
x=[.501:0.001:.599];
y=x+1.282.*sqrt(x)/sqrt(N1);
yf=0.7-1.282*sqrt(0.7)/sqrt(N1)
yt=[y yf];
mediana=median(yt)

x=[0:0.01:100];
x1=x;

for i=1:8
   % if i==1
   %     mediana()
mediana=median(x1)
x1=x1(x1>mediana);
end

x=[10 0.0327
20 0.0899
50 0.2756
100 0.5463
200 0.8618
300 0.9578
400 0.9879
415 0.9901
500 0.9970
600 0.9994]

xx=[86 0.4778 
87 0.4926 
88 0.4915 
89 0.5033 
90 0.492 
91 0.5109 
92 0.5119 
93 0.5142 
146 0.7324 
147 0.7329 
148 0.7364 
149 0.7329 
150 0.742 
151 0.7473 
152 0.7445 
155 0.7573 
160 0.7687 
208 0.8654 
209 0.8648 
210 0.8748 
211 0.8783 
212 0.8809 
214 0.8843 
215 0.8725 
220 0.8871 
256 0.9245 
257 0.9276 
258 0.9294 
259 0.9283 
260 0.9353 
261 0.9319 
262 0.9279 
263 0.9367 
264 0.9344 
265 0.9386 
268 0.9334 
269 0.934 
270 0.9393 
271 0.938 
280 0.9446 
310 0.9643 
312 0.966 
313 0.9677 
314 0.9668 
315 0.9673 
316 0.9658 
317 0.9631 
318 0.9639 
319 0.9656 
320 0.968 
321 0.9676 
322 0.9686 
323 0.9714 
324 0.9683 
340 0.9754 
361 0.9819 
362 0.9831 
363 0.981 
364 0.9818 
365 0.9829 
366 0.9808 
367 0.9812 
368 0.9801 
369 0.983 
370 0.9834 
371 0.981 
372 0.9863 
373 0.985 
374 0.9843 
375 0.9818 
380 0.9866 
390 0.9872 
410 0.9909 
411 0.9907 
412 0.9878 
413 0.9907 
414 0.9908 
415 0.99 
416 0.9909 
417 0.9894 
418 0.9923 ]

x=[1:430];
y=1-(1-0.0107).^x
%y=1-(1-0.01106).^x
y=1-(1-0.009).^x
y=1-(1-0.7.^x).^100

y=(1-0.1.^x).^100
plot(x,y)
hold on
alpha=0.1
for jj=1:430
    xi=[1:jj]
    y2(jj)=1-sum(alpha./xi);
end
plot(x,y2)

x2=[45 0.241 
46 0.2392 
47 0.247 
48 0.258 
49 0.2578 
50 0.272 
51 0.2856 
52 0.2844 
53 0.2824 
54 0.2934 
55 0.3092 
55 0.304 
56 0.3086 
57 0.3082 
58 0.3228 
59 0.3298 
60 0.3281 
61 0.337 
62 0.3504 
63 0.3454 
64 0.3541 
65 0.3536 
66 0.3655 
67 0.3741 
68 0.3732 
69 0.3813 
70 0.3851 
71 0.3903 
72 0.4078 
73 0.4103 
74 0.4159 
75 0.4225 
76 0.4233 
77 0.4387 
78 0.4327 
79 0.4385 
80 0.4465 
81 0.4452 
82 0.4559 
83 0.4718 
84 0.4651 
85 0.4742 
86 0.4836 
87 0.4888 
88 0.4827 
89 0.4983 
90 0.4898 
91 0.501 
92 0.5132 
93 0.5199 
94 0.5197 
95 0.5249 
96 0.5218 
97 0.5385 
98 0.5429 
99 0.5451 
100 0.5561 
101 0.5552 
102 0.5644 
103 0.5664 
104 0.5731 
105 0.5762 
106 0.5809 
107 0.584 
108 0.5872 
109 0.5867 
110 0.5909 
111 0.597 
112 0.6036 
113 0.6083 
114 0.6109 
115 0.6158 
116 0.626 
117 0.6326 
118 0.6269 
119 0.6448 
120 0.6453 
121 0.6338 
122 0.6413 
123 0.6472 
124 0.6564 
125 0.6591 
126 0.6563 
127 0.661 
128 0.6642 
129 0.6741 
130 0.6739 
131 0.6802 
132 0.6809 
133 0.6763 
134 0.6904 
135 0.693 
136 0.6979 
137 0.699 
138 0.7108 
139 0.7001 
140 0.7058 
141 0.7133 
142 0.712 
143 0.7174 
144 0.7282 
145 0.7245 
146 0.7243 
147 0.7317 
148 0.731 
149 0.733 
150 0.7367 
151 0.7424 
152 0.7443 
153 0.7461 
154 0.7546 
155 0.7581 
156 0.7571 
157 0.7622 
158 0.7601 
159 0.7705 
160 0.7645
161 0.769 
162 0.7761  %hasta aca 10000 expermientos
163 0.771 
164 0.7744 
165 0.7798 
166 0.7868 
167 0.7976 
168 0.782 
169 0.7826 
170 0.7892 
171 0.7928 
172 0.797 
173 0.801 
174 0.8024 
175 0.8102 
176 0.7954 
177 0.8104 
178 0.8226 
179 0.825 
180 0.8126 
181 0.8136 
182 0.8224 
183 0.8224 
184 0.8192 
185 0.8292 
186 0.8302 
187 0.828 
188 0.8344 
189 0.8272 
190 0.8434 
191 0.8466 
192 0.8494 
193 0.856 
194 0.849 
195 0.8438 
196 0.851 
197 0.8542 
198 0.8464 
199 0.8554 
200 0.8574 
201 0.8616 
202 0.8508 
203 0.8606 
204 0.8582 
205 0.862 
206 0.8694 
207 0.866 
208 0.8748 
209 0.8682 
210 0.8748 
211 0.8736 
212 0.879 
213 0.8704 
214 0.8844 
215 0.884 
216 0.8794 
217 0.8774 
218 0.8866 
219 0.8738 
220 0.8922 
221 0.8902 
222 0.888 
223 0.8916 
224 0.8884 
225 0.89 
226 0.9006 
227 0.8958 
228 0.898 
229 0.896 
230 0.9008 
231 0.8986 
232 0.902 
233 0.8974 
234 0.9124 
235 0.9008 
236 0.9132 
237 0.9064 
238 0.9122 
239 0.9166 
240 0.9078 
241 0.9116 
242 0.9184 
243 0.918 
244 0.9146 
245 0.9166 
246 0.9222 
247 0.9186 
248 0.9234 
249 0.9184 
250 0.9246 
251 0.9228 
252 0.9246 
253 0.9286 
254 0.9294 
255 0.9272 
256 0.9358 
257 0.9322 
258 0.9324 
259 0.9246 
260 0.9316 
261 0.9292 
262 0.9376 
263 0.9362 
264 0.9274 
265 0.9342 
266 0.9312 
267 0.938 
268 0.9364 
269 0.941 
270 0.9356 
271 0.9348 
272 0.945 
273 0.9386 
274 0.9422 
275 0.9412 
276 0.9458 
277 0.9436 
278 0.9472 
279 0.9452 
280 0.9448 
281 0.943 
282 0.9472 
283 0.954 
284 0.9564 
285 0.949 
286 0.9522 
287 0.9544 
288 0.9558 
289 0.951 
290 0.9532 
291 0.9556 
292 0.9558 
293 0.9536 
294 0.9516 
295 0.9548 
296 0.9544 
297 0.9592 
298 0.9596 
299 0.9588 
300 0.9572 
301 0.9584 
302 0.9596 
303 0.9638 
304 0.9576 
305 0.9644 
306 0.9628 
307 0.9606 
308 0.9616 
309 0.9576 
310 0.9614 
311 0.9634 
312 0.9654 
313 0.9628 
314 0.9642 
315 0.9662 
316 0.973 
317 0.967 
318 0.966 
319 0.9664 
320 0.9646 
321 0.9684 
322 0.9658 
323 0.966 
324 0.965 
325 0.9702 
326 0.9682 
327 0.965 
328 0.9756 
329 0.9694 
330 0.973 
331 0.9732 
332 0.9758 
333 0.9728 
334 0.9762 
335 0.9722 
336 0.973 
337 0.972 
338 0.975 
339 0.9776 
340 0.974 
341 0.9752 
342 0.9724 
343 0.9744 
344 0.9736 
345 0.9772 
346 0.9778 
347 0.9792 
348 0.976 
349 0.9754 
350 0.9788 
351 0.9758 
352 0.9768 
353 0.9796 
354 0.9814 
355 0.9798 
356 0.9804 
357 0.976 
358 0.9806 
359 0.9786 
360 0.9842 
361 0.9806 
362 0.979 
363 0.9828 
364 0.9818 
365 0.9818 
366 0.9842 
367 0.9842 
368 0.9846 
369 0.9836 
370 0.9858 
371 0.9838 
372 0.985 
373 0.9808 
374 0.983 
375 0.9858 
376 0.9852 
377 0.9848 
378 0.9852 
379 0.9862 
380 0.9816 
381 0.9818 
382 0.9864 ]

p=[.5 .75 .875 .9375 .96875 .984375]
(-1/.0107).*log((1-p)/1.2826)
%(-1/.010).*log((1-p)/1.2826)
%1-1.2826.*exp(-0.0107*n)

p=.25
p(2)=1-(1-p(1))*.75
for i=3:7 
    p(i)=1-(1-p(i-1))*.5
end

p=[1/1.125, 1/1.125*.75, 0.5, .75 .875 .9375 .96875 .984375] 


plot((x2(:,1)),(x2(:,2)))
hold on
%plot(x2(:,1),1-1.2826.*exp(-0.0107*x2(:,1)))
plot(x2(:,1),1-1.2916.*exp(-0.01*x2(:,1)))

%(1-1.2826*e^-0.011*m)



alpha=0.05 %supongo 0.1 one tail
alpha=0.125
m=[1:100];

f=1-(1-alpha).^m
plot(m,f)

%c(id,tiros_acum,acumulados,tiros1,aciertos1,p1,s1,tiros2,aciertos2,p2,s2
%tiros3 aciertos3        p3  %s3 tiros4 aciertos4        p4         s4
y1=[15  268  167 85 49 0.5764706 0.08235294  61        39 0.6027397 0.06425227     61        38 0.6086957 0.05422692     61        41 0.6231343 0.04821958]
y2=[72  268  178 85 64 0.7529412 0.09411765     61        38 0.6986301 0.06917469     61        36 0.6666667 0.05675044     61        40 0.6641791 0.04978233]

x=[1 2 3 4]
y1=[0.5764706 0.6027397 0.6086957 0.6231343]
y2=[0.7529412 0.6986301 0.6666667 0.6641791]

x=cumsum([85 61 61 61])
x=[85   146   207   268]
y1=[49 39 38 41 ]
y2=[64 38 36 40 ]

plot(x,y1, x,y2)


x3=[ %si hubiera estado en el primer lugar
50 0.362 
51 0.357 
52 0.377 
53 0.392 
54 0.405 
55 0.42 
56 0.419 
57 0.437 
58 0.399 
59 0.423 
60 0.436 
61 0.425 
62 0.443 
63 0.439 
64 0.463 
65 0.446 
66 0.451 
67 0.474 
68 0.478 
69 0.482 
70 0.476 
71 0.459 
72 0.493 
73 0.511 
74 0.509 
75 0.483 
76 0.539 
77 0.524 
78 0.521 
79 0.506 
80 0.568 
81 0.527 
82 0.538 
83 0.56 
84 0.581 
85 0.549 
86 0.586 
87 0.55 
88 0.578 
89 0.593 
90 0.561 
91 0.591 
92 0.6 
93 0.591 
94 0.626 
95 0.578 
96 0.624 
97 0.615 
98 0.626 
99 0.611 
100 0.593 
101 0.629 
102 0.625 
103 0.665 
104 0.655 
105 0.664 
106 0.65 
107 0.657 
108 0.679 
109 0.663 
110 0.638 
111 0.68 
112 0.655 
113 0.666 
114 0.693 
115 0.697 
116 0.693 
117 0.707 
118 0.691 
119 0.685 
120 0.709 
121 0.708 
122 0.718 
123 0.682 
124 0.697 
125 0.723 
126 0.728 
127 0.699 
128 0.725 
129 0.735 
130 0.747 
131 0.724 
132 0.772 
133 0.748 
134 0.749 
135 0.731 
136 0.763 
137 0.758 
138 0.747 
139 0.753 
140 0.763 
141 0.793 
142 0.789 
143 0.768 
144 0.787 
145 0.783 
146 0.783 
147 0.787 
148 0.807 
149 0.795 
150 0.787
151 0.793 
152 0.786 
153 0.794 
154 0.807 
155 0.792 
156 0.824 
157 0.818 
158 0.806 
159 0.784 
160 0.808 
161 0.814 
162 0.797 
163 0.812 
164 0.812 
165 0.819 
166 0.846 
167 0.809 
168 0.812 
169 0.823 
170 0.819 
171 0.85 
172 0.839 
173 0.832 
174 0.854 
175 0.85 
176 0.847 
177 0.857 
178 0.855 
179 0.858 
180 0.819 
181 0.86 
182 0.864 
183 0.849 
184 0.846 
185 0.863 
186 0.851 
187 0.864 
188 0.864 
189 0.867 
190 0.885 
191 0.869 
192 0.881 
193 0.875 
194 0.9 
195 0.871 
196 0.878 
197 0.892 
198 0.873 
199 0.877 
200 0.881 
201 0.887 
202 0.898 
203 0.888 
204 0.893 
205 0.889 
206 0.892 
207 0.895 
208 0.886 
209 0.893 
210 0.895 
211 0.908 
212 0.895 
213 0.904 
214 0.901 
215 0.915 
216 0.909 
217 0.903 
218 0.91 
219 0.898 
220 0.92 
221 0.905 
222 0.917 
223 0.901 
224 0.911 
225 0.905 
226 0.914 
227 0.901 
228 0.92 
229 0.938 
230 0.913 
231 0.907 
232 0.918 
233 0.927 
234 0.913 
235 0.939 
236 0.921 
237 0.933 
238 0.924 
239 0.92 
240 0.937 
241 0.923 
242 0.926 
243 0.929 
244 0.928 
245 0.941 
246 0.939 
247 0.937 
248 0.937 
249 0.928 
250 0.939 
251 0.94 
252 0.936 
253 0.948 
254 0.945 
255 0.947 
256 0.937 
257 0.944 
258 0.937 
259 0.949 
260 0.953 
261 0.943 
262 0.939 
263 0.948 
264 0.948 
265 0.953 
266 0.961 
267 0.951 
268 0.952 
269 0.951 
270 0.953 
271 0.945 
272 0.955 
273 0.965 
274 0.952 
275 0.959 
276 0.963 
277 0.953 
278 0.966 
279 0.955 
280 0.963 
281 0.959 
282 0.961 
283 0.964 
284 0.965 
285 0.965 
286 0.959 
287 0.953 
288 0.966 
289 0.972 
290 0.954 
291 0.966 
292 0.963 
293 0.969 
294 0.966 
295 0.962 
296 0.965 
297 0.977 
298 0.964 
299 0.967 
300 0.968 
301 0.971 
302 0.963 
303 0.96 
304 0.975 
305 0.968 
306 0.974 
307 0.961 
308 0.978 
309 0.966 
310 0.975 
311 0.981 
312 0.974 
313 0.978 
314 0.975 
315 0.976 
316 0.978 
317 0.972 
318 0.969 
319 0.968 
320 0.978 
321 0.965 
322 0.97 
323 0.973 
324 0.975 
325 0.984 
326 0.972 
327 0.982 
328 0.974 
329 0.98 
330 0.985 
331 0.978 
332 0.98 
333 0.984 
334 0.978 
335 0.978 
336 0.976 
337 0.983 
338 0.974 
339 0.98 
340 0.977 
341 0.986 
342 0.972 
343 0.984 
344 0.985 
345 0.986 
346 0.982 
347 0.976 
348 0.985 
349 0.983 
350 0.985 
351 0.981 
352 0.985 
353 0.981 
354 0.988 
355 0.984 
356 0.981 
357 0.984 
358 0.985 
359 0.991 
360 0.986 
361 0.978 
362 0.987 
363 0.986 
364 0.986 
365 0.987 
366 0.982 
367 0.99 
368 0.986 
369 0.992 
370 0.979 
371 0.986 
372 0.991 
373 0.986 
374 0.988 
375 0.984 
376 0.988 
377 0.991 
378 0.987 
379 0.989 
380 0.983 
381 0.989 
382 0.991 
383 0.986 
384 0.992 
385 0.989 
386 0.987 
387 0.992 
388 0.993 
389 0.988 
390 0.991 
391 0.983 
392 0.99 
393 0.989 
394 0.986 
395 0.992 
396 0.987 
397 0.989 
398 0.98 
399 0.988 
400 0.992]

x4=[30 0.2028 %si solo hay 50
31 0.2198 
32 0.2336 
33 0.2336 
34 0.244 
35 0.2476 
36 0.2608 
37 0.2666 
38 0.2776 
39 0.2842 
40 0.2872 
41 0.2984 
42 0.3 
43 0.3148 
44 0.3138 
45 0.3316 
46 0.3334 
47 0.327 
48 0.3556 
49 0.355 
50 0.3636 
51 0.3584 
52 0.3614 
53 0.3722 
54 0.3856 
55 0.3968 
56 0.4128 
57 0.4078 
58 0.4106 
59 0.4126 
60 0.436 
61 0.4436 
62 0.4378 
63 0.4486 
64 0.4562 
65 0.4534 
66 0.4644 
67 0.4706 
68 0.4796 
69 0.4792 
70 0.49 
71 0.4876 
72 0.514 
73 0.5072 
74 0.517 
75 0.522 
76 0.5266 
77 0.5186 
78 0.5444 
79 0.5446 
80 0.5468 
81 0.5514 
82 0.5512 
83 0.5734 
84 0.567 
85 0.5652 
86 0.5848 
87 0.5888 
88 0.5826 
89 0.596 
90 0.5976 
91 0.606 
92 0.6202 
93 0.6184 
94 0.6074 
95 0.6234 
96 0.6298 
97 0.6388 
98 0.62 
99 0.6438 
100 0.6498] 

x5=[30 0.2988 %si solo hay 25
31 0.3116 
32 0.3206 
33 0.343 
34 0.3428 
35 0.3584 
36 0.3704 
37 0.3684 
38 0.3796 
39 0.4 
40 0.4026 
41 0.4152 
42 0.4146 
43 0.4216 
44 0.4298 
45 0.4462 
46 0.4458 
47 0.4432 
48 0.4632 
49 0.4636 
50 0.4696 
51 0.4852 
52 0.4936 
53 0.4968 
54 0.5032 
55 0.5094 
56 0.503 
57 0.525 
58 0.5216 
59 0.5272 
60 0.5528 
61 0.5518 
62 0.5568 
63 0.565 
64 0.566 
65 0.5818 
66 0.5806 
67 0.5918 
68 0.6004 
69 0.6098 
70 0.5994 
71 0.6114 
72 0.6108 
73 0.6348 
74 0.6254 
75 0.6496 
76 0.637 
77 0.6484 
78 0.6472 
79 0.6608 
80 0.6646 
81 0.6596 
82 0.6676 
83 0.67 
84 0.68 
85 0.6816 
86 0.6918 
87 0.6792 
88 0.6946 
89 0.701 
90 0.702 
91 0.7088 
92 0.7104 
93 0.7332 
94 0.722 
95 0.7306 
96 0.7318 
97 0.7362 
98 0.742 
99 0.7546 
100 0.7336 ]

x6=[30 0.4788 
31 0.485 
32 0.4958 
33 0.513 
34 0.5178 
35 0.5212 
36 0.5286 
37 0.5582 
38 0.5518 
39 0.5592 
40 0.5776 
41 0.5734 
42 0.5796 
43 0.602 
44 0.6008 
45 0.6114 
46 0.6152 
47 0.623 
48 0.6456 
49 0.644 
50 0.644 
51 0.6736 
52 0.648 
53 0.6632 
54 0.6808 
55 0.6814 
56 0.6904 
57 0.7038 
58 0.6982 
59 0.6938 
60 0.702 
61 0.713 
62 0.7072 
63 0.7158 
64 0.7274 
65 0.7286 
66 0.7454 
67 0.7418 
68 0.7414 
69 0.7448 
70 0.7606 
71 0.7668 
72 0.7646 
73 0.773 
74 0.7592 
75 0.7668 
76 0.7754 
77 0.7892 
78 0.7934 
79 0.792 
80 0.803 
81 0.801 
82 0.8028 
83 0.8022 
84 0.8038 
85 0.8226 
86 0.8124 
87 0.8208 
88 0.8336 
89 0.8304 
90 0.8374 
91 0.8382 
92 0.8412 
93 0.8478 
94 0.8324 
95 0.8472 
96 0.8556 
97 0.8508 
98 0.845 
99 0.8592 
100 0.8722 ]


plot(x6(:,1),x6(:,2))

x=[1, 2, 3, 4,5]
y1=[31.5 70 108 144 188 ]
y2=[33 69 108 146 183]




n=[50:100]

nn=[]
cg=[]
cp=[]
k=50

pg=0.7
pp=0.599
for i=1:50
    n=i+50;
    nn(i)=n;
    cg(i)=nchoosek(n,k)*pg^k*(1-pg)^(n-k);
    cp(i)=nchoosek(n,k)*pp^k*(1-pp)^(n-k);
end

plot(nn,cg)
hold on
plot(nn,cp)

k=50
n=83
pg1=nchoosek(n,k)*pg^k*(1-pg)^(n-k)
pp1=nchoosek(n,k)*pp^k*(1-pp)^(n-k)

varg=83*pg*(1-pg)
esperadog=83*pg
(49.5-(esperadog))/sqrt(varg)



k=75
pg=pg1
pp=pp1
for i=1:50
    n=i+100;
    nn(i)=n;
    cg(i)=nchoosek(n,k)*pg^k*(1-pg)^(n-k);
    cp(i)=nchoosek(n,k)*pp^k*(1-pp)^(n-k);
end

plot(nn,cg)
hold on
plot(nn,cp)


nn=[]
cg=[]
cp=[]
k=99
pg=0.7
pp=0.599
for i=1:75
    n=i+400;
    nn(i)=n;
    cg(i)=nchoosek(n,k)*pg^k*(1-pg)^(n-k);
    cp(i)=nchoosek(n,k)*pp^k*(1-pp)^(n-k);
end

plot(nn,cg)
hold on
plot(nn,cp)



k=88
pg=0.7
pp=0.599
for i=1:75
    n=i+88;
    nn(i)=n;
    cg(i)=nchoosek(n,k)*pg^k*(1-pg)^(n-k);
    cp(i)=nchoosek(n,k)*pp^k*(1-pp)^(n-k);
end

plot(nn,cg)
hold on
plot(nn,cp)